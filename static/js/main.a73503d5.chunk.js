(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,o){e.exports=o(27)},16:function(e,t,o){},17:function(e,t,o){},27:function(e,t,o){"use strict";o.r(t);var a=o(0),s=o.n(a),n=o(10),r=o.n(n),c=(o(16),o(1)),i=o(2),m=o(4),l=o(3),u=o(6),d=o(5),h=(o(17),function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"room-list"},s.a.createElement("div",null,s.a.createElement("h3",{className:"your-rooms"},"Your rooms:"),s.a.createElement("div",{className:"all-rooms"},this.props.rooms.map(function(t,o){return s.a.createElement("div",{key:o},s.a.createElement("p",{onClick:function(){return e.props.switchRoom(t.id)},className:"room-name roomLine"+(e.props.selectedRoom===t.id?" active":"")},"\xa0\xa0\xa0#",t.name),s.a.createElement("i",{onClick:function(){return e.props.deleteRoom(t.id)},className:"fas fa-trash fa-sm roomLine"}))}))))}}]),t}(a.Component)),p=function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("p",{className:"sender"},this.props.name),s.a.createElement("p",{className:"message"},this.props.message))}}]),t}(a.Component),b=function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{id:"message-panel",className:"message-panel"},this.props.messages.map(function(e,t){return s.a.createElement(p,{key:t,name:e.name,message:e.message})}))}}]),t}(a.Component),f=function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"form"},s.a.createElement("input",{onChange:this.props.updateRoomVal,value:this.props.roomVal,placeholder:"Create a room",className:"create-a-room"}),s.a.createElement("i",{className:"fas fa-plus",onClick:this.props.makeRoom}))}}]),t}(a.Component),R=function(e){function t(e){var o;return Object(c.a)(this,t),(o=Object(m.a)(this,Object(l.a)(t).call(this,e))).state={textVal:""},o}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"send"},s.a.createElement("textarea",{id:"text-area",onKeyPress:this.props.submit,placeholder:"Type message & hit enter",value:this.props.textVal,onChange:this.props.handleChange}))}}]),t}(a.Component),g=o(7),v=o.n(g),j=function(e){function t(e){var o;return Object(c.a)(this,t),(o=Object(m.a)(this,Object(l.a)(t).call(this,e))).state={roomId:"",textVal:"",messages:[],roomVal:"",joinableRooms:[],joinedRooms:[],allRooms:[]},o.updateTextVal=o.updateTextVal.bind(Object(u.a)(o)),o.submit=o.submit.bind(Object(u.a)(o)),o.makeRoom=o.makeRoom.bind(Object(u.a)(o)),o.updateRoomVal=o.updateRoomVal.bind(Object(u.a)(o)),o.getRooms=o.getRooms.bind(Object(u.a)(o)),o.deleteRoom=o.deleteRoom.bind(Object(u.a)(o)),o.switchRoom=o.switchRoom.bind(Object(u.a)(o)),o}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;new v.a.ChatManager({instanceLocator:"v1:us1:0e96fcde-6705-4b06-8703-1fb324bca30a",userId:"amy wang",tokenProvider:new v.a.TokenProvider({url:"https://us1.pusherplatform.io/services/chatkit_token_provider/v1/0e96fcde-6705-4b06-8703-1fb324bca30a/token"})}).connect().then(function(t){e.currentUser=t,e.getRooms(),console.log("Connected as user ",t);var o=[];t.subscribeToRoomMultipart({roomId:t.rooms[0].id,hooks:{onMessage:function(a){o.push({name:a.senderId,message:a.parts[0].payload.content}),e.setState({messages:o,roomId:t.rooms[0].id})}}})}).catch(function(e){console.error("error:",e)})}},{key:"switchRoom",value:function(e){var t=this;console.log("SWITCH ROOM to "+e),this.setState({messages:[]});var o=[];this.currentUser.subscribeToRoom({roomId:e,hooks:{onMessage:function(a){o.push({name:a.senderId,message:a.text}),t.setState({roomId:e,messages:o})}}}).then(function(e){t.setState({roomId:e.id}),t.getRooms()}).catch(function(e){return console.log("error on subscribing to room: ",e)})}},{key:"deleteRoom",value:function(e){var t=this;this.currentUser.deleteRoom({roomId:e}).then(function(){console.log("deleted room with ID: ".concat(e)),console.log(t.state.allRooms),t.setState({joinableRooms:t.state.joinableRooms.filter(function(t){return t.id!==e}),joinedRooms:t.state.joinedRooms.filter(function(t){return t.id!==e}),allRooms:t.state.allRooms.filter(function(t){return t.id!==e})})}).catch(function(t){console.log("error deleted room ".concat(e,": ").concat(t))})}},{key:"makeRoom",value:function(){var e=this;console.log("making room called "+this.state.roomVal);var t=this.state.roomVal;0!==t.length?this.currentUser.createRoom({name:t}).then(function(t){e.setState({roomVal:"",joinedRooms:e.state.joinedRooms.concat(t),allRooms:e.state.allRooms.concat(t)})}).catch(function(e){return console.log("error with createRoom: ",e)}):alert("Room name is empty")}},{key:"getRooms",value:function(){var e=this;this.currentUser.getJoinableRooms().then(function(t){console.log(e.currentUser.rooms),e.setState({joinableRooms:t,joinedRooms:e.currentUser.rooms,allRooms:t.concat(e.currentUser.rooms)})}).catch(function(e){return console.log("error on joinableRooms: ",e)})}},{key:"submit",value:function(e){if(13===e.which||13===e.keyCode){var t=e.target.value.trim();if(0===t.length)return void alert("Message box is empty");var o=this.state.messages.slice();o.push({name:"anonymous",message:t}),this.setState({textVal:"",messages:o}),this.currentUser.sendMessage({text:t,roomId:this.state.roomId})}}},{key:"updateTextVal",value:function(e){this.setState({textVal:e.target.value})}},{key:"updateRoomVal",value:function(e){this.setState({roomVal:e.target.value})}},{key:"render",value:function(){return s.a.createElement("div",{className:"App"},s.a.createElement("div",{className:"row"},s.a.createElement(h,{className:"RoomList",rooms:this.state.allRooms,deleteRoom:this.deleteRoom,switchRoom:this.switchRoom,selectedRoom:this.state.roomId}),s.a.createElement(b,{className:"MessageList",messages:this.state.messages})),s.a.createElement("div",{className:"row"},s.a.createElement(f,{className:"NewRoomForm",makeRoom:this.makeRoom,roomVal:this.state.roomVal,updateRoomVal:this.updateRoomVal}),s.a.createElement(R,{className:"SendMessage",handleChange:this.updateTextVal,textVal:this.state.textVal,submit:this.submit})))}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[11,1,2]]]);
//# sourceMappingURL=main.a73503d5.chunk.js.map